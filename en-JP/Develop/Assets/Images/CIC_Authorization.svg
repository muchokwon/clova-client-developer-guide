<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1322.6928px" preserveAspectRatio="none" style="width:883px;height:1322px;" version="1.1" viewBox="0 0 883 1322" width="883.2313px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="145.6232" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="73.2436" y="1162.1779"/><rect fill="#FFFFFF" height="142.6555" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="221.8849" y="46.3074"/><rect fill="#FFFFFF" height="893.9407" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="221.8849" y="268.2372"/><rect fill="#FFFFFF" height="223.5567" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="545.3774" y="672.6981"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="119.8371"/><rect fill="#FFFFFF" height="150.5544" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="188.9629"/><rect fill="#FFFFFF" height="229.2059" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="408.9293"/><rect fill="#FFFFFF" height="54.8598" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="786.5353"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="1011.0009"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="1227.1861"/><rect fill="#FFFFFF" height="21.5422" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="843.0192" y="1080.1267"/><rect fill="#FFFFFF" height="11.4892" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="843.0192" y="1296.312"/><rect fill="#FFFFFF" height="134.7567" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="658.8331" x="166.5932" y="199.734"/><rect fill="#FFFFFF" height="60.509" style="stroke: none; stroke-width: 0.7180742554059567;" width="658.8331" x="166.5932" y="273.9818"/><rect fill="#FFFFFF" height="413.1732" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="658.8331" x="166.5932" y="488.8262"/><rect fill="#FFFFFF" height="338.9254" style="stroke: none; stroke-width: 0.7180742554059567;" width="658.8331" x="166.5932" y="563.074"/><rect fill="#FFFFFF" height="390.0041" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="865.6385" x="9.335" y="912.0525"/><rect fill="#FFFFFF" height="194.643" style="stroke: none; stroke-width: 0.7180742554059567;" width="865.6385" x="9.335" y="1107.4136"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="76.8339" x2="76.8339" y1="39.1266" y2="1314.2638"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="225.4753" x2="225.4753" y1="39.1266" y2="1314.2638"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="362.9865" x2="362.9865" y1="39.1266" y2="1314.2638"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="548.9678" x2="548.9678" y1="39.1266" y2="1314.2638"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="737.1032" x2="737.1032" y1="39.1266" y2="1314.2638"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 5.0,5.0;" x1="846.2505" x2="846.2505" y1="39.1266" y2="1314.2638"/><rect fill="#9EA0CA" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="120.6365" x="16.5157" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96.222" x="28.723" y="24.0807">Client without GUI</text><rect fill="#9EA0CA" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="103.4027" x="173.774" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78.9882" x="185.9812" y="24.0807">Client with GUI</text><rect fill="#05D686" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="155.8221" x="285.4345" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131.4076" x="297.6418" y="24.0807">LINE authorization server</text><rect fill="#05D686" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="201.0608" x="448.4374" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="176.6463" x="460.6446" y="24.0807">Clova terms-and-conditions page</text><rect fill="#05D686" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="161.5667" x="656.6789" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137.1522" x="668.8862" y="24.0807">Clova authorization server</text><rect fill="#05D686" height="36.2543" rx="3.5904" ry="3.5904" style="stroke: #FFFFFF; stroke-width: 1.0771113831089352;" width="42.3664" x="825.4264" y="2.1542"/><text fill="#FFFFFF" font-family="sans-serif" font-size="10.053" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17.9519" x="837.6336" y="24.0807">CIC</text><rect fill="#FFFFFF" height="145.6232" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="73.2436" y="1162.1779"/><rect fill="#FFFFFF" height="142.6555" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="221.8849" y="46.3074"/><rect fill="#FFFFFF" height="893.9407" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="221.8849" y="268.2372"/><rect fill="#FFFFFF" height="223.5567" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="545.3774" y="672.6981"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="119.8371"/><rect fill="#FFFFFF" height="150.5544" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="188.9629"/><rect fill="#FFFFFF" height="229.2059" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="408.9293"/><rect fill="#FFFFFF" height="54.8598" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="786.5353"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="1011.0009"/><rect fill="#FFFFFF" height="34.5629" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="733.8719" y="1227.1861"/><rect fill="#FFFFFF" height="21.5422" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="843.0192" y="1080.1267"/><rect fill="#FFFFFF" height="11.4892" style="stroke: #000000; stroke-width: 0.7180742554059567;" width="7.1807" x="843.0192" y="1296.312"/><polygon fill="#000000" points="354.7287,82.4018,361.9094,85.2741,354.7287,88.1464,357.601,85.2741" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="359.0371" y1="85.2741" y2="85.2741"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="86.887" x="251.326" y="64.6912">Start LINE OAuth with</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="102.6846" x="244.8633" y="74.8396">client_id and redirect_uri</text><polygon fill="#000000" points="725.255,116.9648,732.4357,119.8371,725.255,122.7094,728.1273,119.8371" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="363.3456" x2="729.5634" y1="119.8371" y2="119.8371"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="323.1334" x="387.042" y="109.4025">HTTP Redirect to grant web page for Clova authentication with LINE auth code</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="154.4" y2="151.5277"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="154.4" y2="157.2723"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="736.7442" y1="154.4" y2="154.4"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="89.0412" x="438.7434" y="143.9655">Show grant web page</text><polygon fill="#000000" points="725.255,186.0906,732.4357,188.9629,725.255,191.8352,728.1273,188.9629" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="225.4753" x2="729.5634" y1="188.9629" y2="188.9629"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="31.5953" x="463.876" y="178.5284">Tap OK</text><path d="M170.1836,199.734 L224.7572,199.734 L224.7572,218.404 L217.5765,225.5847 L166.5932,225.5847 L166.5932,203.3244 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><rect fill="none" height="134.7567" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="658.8331" x="166.5932" y="199.734"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4892" x="184.5451" y="215.9636">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112.0196" x="242.7091" y="216.6817">["3rd party Android app"]</text><polygon fill="#000000" points="236.9645,265.3649,229.7838,268.2372,236.9645,271.1095,234.0922,268.2372" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="232.6561" x2="733.1538" y1="268.2372" y2="268.2372"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="248.4537" x="357.2419" y="257.8027">intent://package=com.3rdparty.app&amp;code=abc&amp;state=xyz</text><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="166.5932" x2="825.4264" y1="274.6999" y2="274.6999"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80.4243" x="177.3643" y="290.2114">["web app or iOS"]</text><polygon fill="#000000" points="236.9645,325.8739,229.7838,328.7462,236.9645,331.6185,234.0922,328.7462" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="232.6561" x2="733.1538" y1="328.7462" y2="328.7462"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="175.2101" x="393.8637" y="318.3117">http://redirect_uri/&amp;code=abc&amp;state=xyz</text><polygon fill="#000000" points="725.255,406.057,732.4357,408.9293,725.255,411.8016,728.1273,408.9293" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="729.5634" y1="408.9293" y2="408.9293"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="265.6875" x="348.6251" y="357.9011">Request Clova OAuth authorization code (send next information)</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="151.5137" x="348.6251" y="368.0495">- Authorization code of LINE account</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="142.8968" x="348.6251" y="378.1979">- grant_type=uauth_auth_code_v2</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="78.9882" x="348.6251" y="388.3463">- Client credentials</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="252.7621" x="354.3696" y="398.4947">(CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)</text><polygon fill="#000000" points="371.2444,440.6199,364.0636,443.4922,371.2444,446.3645,368.3721,443.4922" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="366.9359" x2="733.1538" y1="443.4922" y2="443.4922"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="192.4439" x="452.3868" y="433.0577">LINE access token request with LINE auth code</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="478.0551" y2="475.1828"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="478.0551" y2="480.9274"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="363.3456" x2="733.1538" y1="478.0551" y2="478.0551"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="73.9616" x="511.6279" y="467.6206">LINE access token</text><path d="M170.1836,488.8262 L224.7572,488.8262 L224.7572,507.4962 L217.5765,514.6769 L166.5932,514.6769 L166.5932,492.4166 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><rect fill="none" height="413.1732" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="658.8331" x="166.5932" y="488.8262"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4892" x="184.5451" y="505.0558">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252.0441" x="242.7091" y="505.7739">["User agreed to terms-of-service agreement" == "Yes"]</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="557.3294" y2="554.4571"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="557.3294" y2="560.2017"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="733.1538" y1="557.3294" y2="557.3294"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="147.9233" x="407.5071" y="546.8949">Return authorization code (200 OK)</text><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="166.5932" x2="825.4264" y1="563.7921" y2="563.7921"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="272.1501" x="177.3643" y="579.3036">["User agreed to terms-and-conditions agreement" == "No"]</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="638.1352" y2="635.2629"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="638.1352" y2="641.0075"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="736.7442" y1="638.1352" y2="638.1352"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="106.9931" x="407.8662" y="607.4039">Return authorization code</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="66.0628" x="407.8662" y="617.5523">and redirect_uri</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="150.7956" x="407.8662" y="627.7007">(451 Unavailable For Legal Reasons)</text><polygon fill="#000000" points="536.7605,669.8258,543.9412,672.6981,536.7605,675.5704,539.6328,672.6981" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="541.069" y1="672.6981" y2="672.6981"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="219.0126" x="277.7152" y="662.2636">Redirect to terms-and-conditions page (redirect_uri)</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="707.2611" y2="704.3888"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="707.2611" y2="710.1334"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="544.6593" y1="707.2611" y2="707.2611"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="138.5883" x="317.9274" y="696.8266">Show terms-and-conditions page</text><polygon fill="#000000" points="536.7605,738.9517,543.9412,741.824,536.7605,744.6963,539.6328,741.824" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="541.069" y1="741.824" y2="741.824"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="83.2966" x="345.5732" y="731.3895">Tap agree/disagree</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="786.5353" y2="783.663"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="786.5353" y2="789.4076"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="552.5581" x2="733.1538" y1="786.5353" y2="786.5353"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="124.9449" x="580.7426" y="765.9524">Send result of user agreement</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="138.5883" x="573.9208" y="776.1008">to terms-and-conditions (submit)</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="552.5581" x2="559.7389" y1="841.3951" y2="838.5228"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="552.5581" x2="559.7389" y1="841.3951" y2="844.2674"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="552.5581" x2="736.7442" y1="841.3951" y2="841.3951"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="106.9931" x="570.6895" y="810.6638">Return result (302 Found)</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="121.3545" x="570.6895" y="820.8122">- clova://agreement-success</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="148.6414" x="570.6895" y="830.9606">- Failure: clova://agreement-failure</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="896.2548" y2="893.3825"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="896.2548" y2="899.1271"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="548.2497" y1="896.2548" y2="896.2548"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="106.9931" x="314.696" y="865.5235">Return result (302 Found)</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="121.3545" x="314.696" y="875.6719">- clova://agreement-success</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="148.6414" x="314.696" y="885.8203">- Failure: clova://agreement-failure</text><path d="M12.9253,912.0525 L67.499,912.0525 L67.499,930.7224 L60.3182,937.9032 L9.335,937.9032 L9.335,915.6428 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.7180742554059567;"/><rect fill="none" height="390.0041" rx="3.5904" ry="3.5904" style="stroke: #000000; stroke-width: 1.4361485108119134;" width="865.6385" x="9.335" y="912.0525"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4892" x="27.2868" y="928.2821">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="156.5402" x="85.4508" y="929.0002">["Client type" == "Client with GUI"]</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="1011.0009" y2="1008.1286"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="1011.0009" y2="1013.8732"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="733.1538" y1="1011.0009" y2="1011.0009"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="213.9861" x="352.2154" y="970.1211">Request Clova access token (send next information)</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="85.4508" x="352.2154" y="980.2695">- Authorization code</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="78.9882" x="352.2154" y="990.4179">- Client credentials</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="252.7621" x="357.96" y="1000.5664">(CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="1045.5638" y2="1042.6915"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="236.2464" y1="1045.5638" y2="1048.4361"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="229.0657" x2="736.7442" y1="1045.5638" y2="1045.5638"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="108.4292" x="429.0494" y="1035.1293">Return Clova access token</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="841.583" x2="834.4023" y1="1080.1267" y2="1077.2544"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="841.583" x2="834.4023" y1="1080.1267" y2="1082.999"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="229.0657" x2="842.3011" y1="1080.1267" y2="1080.1267"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="198.1885" x="436.9482" y="1069.6922">Start connection to CIC using Clova access token</text><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="9.335" x2="874.9735" y1="1108.1316" y2="1108.1316"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171.6197" x="20.1061" y="1123.6432">["Client type" == "Client without GUI"]</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="87.6051" y1="1162.1779" y2="1159.3056"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="87.6051" y1="1162.1779" y2="1165.0502"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="224.7572" y1="1162.1779" y2="1162.1779"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="113.4557" x="96.222" y="1151.7434">Forward authorization code</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="1227.1861" y2="1224.3138"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="732.4357" x2="725.255" y1="1227.1861" y2="1230.0584"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="733.1538" y1="1227.1861" y2="1227.1861"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="213.9861" x="277.8947" y="1186.3064">Request Clova access token (send next information)</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="85.4508" x="277.8947" y="1196.4548">- Authorization code</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="78.9882" x="277.8947" y="1206.6032">- Client credentials</text><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="252.7621" x="283.6393" y="1216.7516">(CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="87.6051" y1="1261.749" y2="1258.8767"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="87.6051" y1="1261.749" y2="1264.6213"/><line style="stroke: #000000; stroke-width: 0.7180742554059567; stroke-dasharray: 2.0,2.0;" x1="80.4243" x2="736.7442" y1="1261.749" y2="1261.749"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="101.2485" x="358.3191" y="1251.3145">Send Clova access token</text><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="841.583" x2="834.4023" y1="1296.312" y2="1293.4397"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="841.583" x2="834.4023" y1="1296.312" y2="1299.1843"/><line style="stroke: #000000; stroke-width: 0.7180742554059567;" x1="80.4243" x2="842.3011" y1="1296.312" y2="1296.312"/><text fill="#000000" font-family="sans-serif" font-size="8.6169" lengthAdjust="spacingAndGlyphs" textLength="198.1885" x="362.6275" y="1285.8774">Start connection to CIC using Clova access token</text><!--
@startuml
scale max 880 width
skinparam sequenceMessageAlign center
skinparam shadowing false
skinparam roundcorner 10
skinparam padding 10
skinparam defaultFontSize 12
skinparam sequence {
	ArrowColor #000000
	ActorBorderColor #000000
	ActorFontStyle Bolder

	LifeLineBorderColor #000000
	LifeLineBackgroundColor transparent
	ParticipantBorderColor transparent
	ParticipantFontSize 14
	ParticipantFontColor #ffffff
	ParticipantFontStyle bold

	BoxBorderColor #000000
	BoxFontColor #ffffff
    BoxFontSize 14
    BoxFontStyle bold
}
skinparam note {
	BackgroundColor #9EA0CA
	BorderColor #ffffff
	FontColor #ffffff
	FontSize 14
	FontStyle bold
}
hide footbox

participant "Client without GUI" as device #9EA0CA
participant "Client with GUI" as app #9EA0CA
participant "LINE authorization server" as lauth #05D686
participant "Clova terms-and-conditions page" as term #05D686
participant "Clova authorization server" as cauth #05D686
participant CIC as cic #05D686

activate app
app -> lauth: Start LINE OAuth with \nclient_id and redirect_uri

lauth -> cauth: HTTP Redirect to grant web page for Clova authentication with LINE auth code
activate cauth
cauth - ->> app: Show grant web page
deactivate cauth

app -> cauth: Tap OK
deactivate app

activate cauth

alt "3rd party Android app"
  cauth -> app: intent://package=com.3rdparty.app&code=abc&state=xyz
  activate app

else "web app or iOS"
  cauth -> app: http://redirect_uri/&code=abc&state=xyz
end

deactivate cauth

app -> cauth: Request Clova OAuth authorization code (send next information)\l- Authorization code of LINE account\l- grant_type=uauth_auth_code_v2\l- Client credentials\l  (CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)

activate cauth

cauth -> lauth: LINE access token request with LINE auth code
lauth - ->> cauth: LINE access token

alt "User agreed to terms-of-service agreement" == "Yes"
  cauth - ->> app: Return authorization code (200 OK)
else "User agreed to terms-and-conditions agreement" == "No"
  cauth - ->> app: Return authorization code\land redirect_uri\l(451 Unavailable For Legal Reasons)
  deactivate cauth
  app -> term: Redirect to terms-and-conditions page (redirect_uri)
  activate term
  term - ->> app: Show terms-and-conditions page
  app -> term: Tap agree/disagree
  term ->> cauth: Send result of user agreement\nto terms-and-conditions (submit)
  activate cauth
  cauth - ->> term: Return result (302 Found)\l- clova://agreement-success\l- Failure: clova://agreement-failure
  deactivate cauth
  term - ->> app: Return result (302 Found)\l- clova://agreement-success\l- Failure: clova://agreement-failure
  deactivate term
end

alt "Client type" == "Client with GUI"
  app ->> cauth: Request Clova access token (send next information)\l- Authorization code\l- Client credentials\l  (CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)

  activate cauth
  cauth - ->> app: Return Clova access token
  deactivate cauth

  app ->> cic: Start connection to CIC using Clova access token
  activate cic
  deactivate cic

else "Client type" == "Client without GUI"
  app ->> device: Forward authorization code
  deactivate app

  activate device
  device ->> cauth: Request Clova access token (send next information)\l- Authorization code\l- Client credentials\l  (CLOVA_OAUTH_CLIENT_ID, CLOVA_OAUTH_CLIENT_SECRET)

  activate cauth
  cauth - ->> device: Send Clova access token
  deactivate cauth

  device ->> cic: Start connection to CIC using Clova access token

  activate cic
end

@enduml

PlantUML version 1.2019.02(Sat Mar 02 06:20:40 JST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.1+13
Operating System: Mac OS X
OS Version: 10.12.6
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>