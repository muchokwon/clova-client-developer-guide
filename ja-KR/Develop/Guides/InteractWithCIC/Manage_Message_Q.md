## メッセージキューを管理する {#ManageMessageQ}

クライアントは、CICと連続的にメッセージのやり取りをします。その際、クライアントがCICから受信するディレクティブは、次のような特徴があります。

* 一度に複数のディレクティブと追加の情報が含まれたメッセージを受信することがあります。
* 受信したディレクティブの[ダイアログID](/Develop/Guides/Manage_Dialogue_ID_And_Handle_Tasks.md)は、それぞれ異なることがあります。
* CICがディレクティブを送信する際、順序は保証されません。

上記のような特徴により、クライアントは、ディレクティブを順番通りに格納し、取り出すことができるデータ構造のキュー（queue）を使用する必要があります。それをメッセージキューといいます。

<div class="note">
  <p><strong>メモ</strong></p>
  <p>ダイアログIDが含まれていないディレクティブを受信すると、直ちに処理する必要があります。</p>
</div>

開発者は、それぞれのメッセージキューに格納されたディレクティブが1つずつ処理されるように開発し、その際クライアントに保存されているユーザーの最終リクエストに対応するメッセージが処理されるようにする必要があります。ユーザのリクエストは[ダイアログID](/Develop/Guides/Manage_Dialogue_ID_And_Handle_Tasks.md)で識別できるので、クライアントは、最終リクエストのダイアログIDを保管する必要があります。もし、クライアントがすでにキャンセルされたダイアログIDを持つディレクティブをキューに保存していた場合、そのメッセージとそれに対応する追加の情報をキューから削除する必要があります。

クライアント開発者の判断、または計画されたUXに応じて、次の事項を決定します。
* 管理するメッセージキューの数と大きさ
* メッセージキュー間の処理の優先順位

例えば、オーディオ再生（[AudioPlayer](/Develop/References/MessageInterfaces/AudioPlayer.md)）のように、ユーザーの音声入力やクライアントの音声出力が行われている間にも、途切れることなくアクションを実行するUXを提供する場合、関連するメッセージキューのディレクティブを別個に処理する必要があります。一部APIの名前空間は、同時に1つのディレクティブのみを送信します。その場合、その名前空間に対して、メッセージキューを別個に管理する必要がないこともあります。
