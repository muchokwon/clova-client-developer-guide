<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1188.1929px" preserveAspectRatio="none" style="width:883px;height:1188px;" version="1.1" viewBox="0 0 883 1188" width="883.8578px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="178.7969" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="117.8763" y="992.0762"/><rect fill="#FFFFFF" height="237.1724" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="56.2457"/><rect fill="#FFFFFF" height="25.7185" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="390.5321"/><rect fill="#FFFFFF" height="488.999" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="503.0772"/><rect fill="#FFFFFF" height="55.0268" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="587.2382" y="144.7065"/><rect fill="#FFFFFF" height="398.6629" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="267.6997"/><rect fill="#FFFFFF" height="42.0872" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="808.2964"/><rect fill="#FFFFFF" height="42.0872" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="1072.9822"/><rect fill="#FFFFFF" height="25.7185" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="836.2786" y="892.4708"/><rect fill="#FFFFFF" height="13.7165" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="836.2786" y="1157.1566"/><rect fill="#FFFFFF" height="366.9435" rx="4.2864" ry="4.2864" style="stroke: #000000; stroke-width: 1.7145640526059425;" width="591.096" x="224.6079" y="306.2774"/><rect fill="#FFFFFF" height="250.112" style="stroke: none; stroke-width: 0.8572820263029712;" width="591.096" x="224.6079" y="423.1089"/><rect fill="#FFFFFF" height="478.792" rx="4.2864" ry="4.2864" style="stroke: #000000; stroke-width: 1.7145640526059425;" width="862.8544" x="11.1447" y="685.2228"/><rect fill="#FFFFFF" height="238.9674" style="stroke: none; stroke-width: 0.8572820263029712;" width="862.8544" x="11.1447" y="925.0475"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 5.0,5.0;" x1="121.734" x2="121.734" y1="47.6729" y2="1178.5887"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 5.0,5.0;" x1="329.1963" x2="329.1963" y1="47.6729" y2="1178.5887"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 5.0,5.0;" x1="591.096" x2="591.096" y1="47.6729" y2="1178.5887"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 5.0,5.0;" x1="736.8339" x2="736.8339" y1="47.6729" y2="1178.5887"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 5.0,5.0;" x1="840.565" x2="840.565" y1="47.6729" y2="1178.5887"/><rect fill="#9EA0CA" height="44.2438" rx="4.2864" ry="4.2864" style="stroke: #FFFFFF; stroke-width: 1.285923039454457;" width="204.8904" x="19.7175" y="2.5718"/><text fill="#FFFFFF" font-family="Noto Sans CJK JP" font-size="12.0019" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175.7428" x="34.2913" y="29.6047">GUIを提供しないクライアント</text><rect fill="#9EA0CA" height="44.2438" rx="4.2864" ry="4.2864" style="stroke: #FFFFFF; stroke-width: 1.285923039454457;" width="192.0312" x="233.1807" y="2.5718"/><text fill="#FFFFFF" font-family="Noto Sans CJK JP" font-size="12.0019" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162.8836" x="247.7545" y="29.6047">GUIを提供するクライアント</text><rect fill="#05D686" height="44.2438" rx="4.2864" ry="4.2864" style="stroke: #FFFFFF; stroke-width: 1.285923039454457;" width="132.8787" x="525.0852" y="2.5718"/><text fill="#FFFFFF" font-family="Noto Sans CJK JP" font-size="12.0019" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103.7311" x="539.659" y="29.6047">LINE認可サーバー</text><rect fill="#05D686" height="44.2438" rx="4.2864" ry="4.2864" style="stroke: #FFFFFF; stroke-width: 1.285923039454457;" width="140.5943" x="666.5368" y="2.5718"/><text fill="#FFFFFF" font-family="Noto Sans CJK JP" font-size="12.0019" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111.4467" x="681.1106" y="29.6047">Clova認可サーバー</text><rect fill="#05D686" height="44.2438" rx="4.2864" ry="4.2864" style="stroke: #FFFFFF; stroke-width: 1.285923039454457;" width="49.7224" x="815.7038" y="2.5718"/><text fill="#FFFFFF" font-family="Noto Sans CJK JP" font-size="12.0019" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20.5748" x="830.2776" y="29.6047">CIC</text><rect fill="#FFFFFF" height="178.7969" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="117.8763" y="992.0762"/><rect fill="#FFFFFF" height="237.1724" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="56.2457"/><rect fill="#FFFFFF" height="25.7185" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="390.5321"/><rect fill="#FFFFFF" height="488.999" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="324.9099" y="503.0772"/><rect fill="#FFFFFF" height="55.0268" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="587.2382" y="144.7065"/><rect fill="#FFFFFF" height="398.6629" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="267.6997"/><rect fill="#FFFFFF" height="42.0872" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="808.2964"/><rect fill="#FFFFFF" height="42.0872" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="732.5475" y="1072.9822"/><rect fill="#FFFFFF" height="25.7185" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="836.2786" y="892.4708"/><rect fill="#FFFFFF" height="13.7165" style="stroke: #000000; stroke-width: 0.8572820263029712;" width="8.5728" x="836.2786" y="1157.1566"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="369.4886" y1="91.4747" y2="91.4747"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="369.4886" x2="369.4886" y1="91.4747" y2="102.6193"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="334.34" x2="369.4886" y1="102.6193" y2="102.6193"/><polygon fill="#000000" points="342.9128,99.1902,334.34,102.6193,342.9128,106.0485,339.4837,102.6193" style="stroke: #000000; stroke-width: 0.8572820263029712;"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="64.2962" x="348.0565" y="78.9269">LINEログイン</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="585.5236" x2="576.9508" y1="144.7065" y2="141.2774"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="585.5236" x2="576.9508" y1="144.7065" y2="148.1357"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="586.3809" y1="144.7065" y2="144.7065"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="146.5952" x="387.0628" y="132.1587">LINEアカウント情報を送信する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="199.7333" y2="196.3042"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="199.7333" y2="203.1624"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="333.4827" x2="590.6673" y1="199.7333" y2="199.7333"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="84.8709" x="420.0682" y="174.2459">LINEアカウントの</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="133.736" x="395.6357" y="187.1855">アクセストークンを送信する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="267.6997" y2="264.2706"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="267.6997" y2="271.1288"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="731.6902" y1="267.6997" y2="267.6997"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="233.1807" x="408.2806" y="229.2727">認可コードをリクエストする(次の情報を送信する)</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="173.171" x="408.2806" y="242.2123">- LINEアカウントのアクセストークン</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="249.4691" x="408.2806" y="255.1519">- クライアント認証情報(CLOVA_OAUTH_CLIENT_ID)</text><path d="M228.8943,306.2774 L292.3332,306.2774 L292.3332,329.424 L283.7604,337.9968 L224.6079,337.9968 L224.6079,310.5638 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.8572820263029712;"/><rect fill="none" height="366.9435" rx="4.2864" ry="4.2864" style="stroke: #000000; stroke-width: 1.7145640526059425;" width="591.096" x="224.6079" y="306.2774"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12.0019" x="246.0399" y="326.3867">alt</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245.1827" x="313.7652" y="327.244">["利用規約に同意しているか" == "同意している"]</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="390.5321" y2="387.103"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="390.5321" y2="393.9613"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="333.4827" x2="731.6902" y1="390.5321" y2="390.5321"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="144.8807" x="460.5748" y="377.9844">認可コードを送信する(200 OK)</text><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="224.6079" x2="815.7038" y1="423.9661" y2="423.9661"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246.0399" x="237.4671" y="443.2182">[利用規約に同意しているか == "同意していない"]</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="503.0772" y2="499.6481"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="503.0772" y2="506.5063"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="333.4827" x2="731.6902" y1="503.0772" y2="503.0772"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="174.8855" x="444.7151" y="477.5898">authorization、redirect_uriを送信する</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="176.6001" x="444.7151" y="490.5294">(451 Unavailable For Legal Reasons)</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="369.4886" y1="545.1644" y2="545.1644"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="369.4886" x2="369.4886" y1="545.1644" y2="556.3091"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="334.34" x2="369.4886" y1="556.3091" y2="556.3091"/><polygon fill="#000000" points="342.9128,552.8799,334.34,556.3091,342.9128,559.7382,339.4837,556.3091" style="stroke: #000000; stroke-width: 0.8572820263029712;"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="224.6079" x="348.0565" y="532.6166">利用規約ページ(redirect_uri)にリダイレクトする</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="598.3962" y2="594.9671"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="598.3962" y2="601.8254"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="731.6902" y1="598.3962" y2="598.3962"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="193.7457" x="436.1422" y="585.8485">利用規約への同意結果を送信する(submit)</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="666.3626" y2="662.9335"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="666.3626" y2="669.7918"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="333.4827" x2="735.9766" y1="666.3626" y2="666.3626"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="129.4496" x="453.2879" y="627.9356">結果を送信する(302 Found)</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="163.7409" x="453.2879" y="640.8752">- 成功：clova://agreement-success</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="152.5962" x="453.2879" y="653.8148">- 失敗：clova://agreement-failure</text><path d="M15.4311,685.2228 L78.8699,685.2228 L78.8699,708.3695 L70.2971,716.9423 L11.1447,716.9423 L11.1447,689.5093 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.8572820263029712;"/><rect fill="none" height="478.792" rx="4.2864" ry="4.2864" style="stroke: #000000; stroke-width: 1.7145640526059425;" width="862.8544" x="11.1447" y="685.2228"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="12.0019" x="32.5767" y="705.3321">alt</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="283.7604" x="100.302" y="706.1894">["クライアントタイプ" == "GUIを提供するクライアント"]</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="808.2964" y2="804.8673"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="808.2964" y2="811.7255"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="731.6902" y1="808.2964" y2="808.2964"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="283.7604" x="372.2747" y="756.9298">Clovaアクセストークンをリクエストし、次の情報を送信する</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="173.171" x="372.2747" y="769.8694">- LINEアカウントのアクセストークン</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="108.8748" x="372.2747" y="782.809">- クライアント認証情報</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="316.3371" x="377.4184" y="795.7486">(CLOVA_OAUTH_CLIENT_ID、CLOVA_OAUTH_CLIENT_SECRET)</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="850.3836" y2="846.9545"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="342.0555" y1="850.3836" y2="853.8127"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="333.4827" x2="735.9766" y1="850.3836" y2="850.3836"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="160.3117" x="455.0024" y="837.8358">Clovaアクセストークンを送信する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="834.5641" x2="825.9912" y1="892.4708" y2="889.0416"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="834.5641" x2="825.9912" y1="892.4708" y2="895.8999"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="333.4827" x2="835.4213" y1="892.4708" y2="892.4708"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="260.6137" x="454.5738" y="879.923">Clovaアクセストークンを使ってCICとの接続を開始する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="11.1447" x2="873.999" y1="925.9048" y2="925.9048"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="294.905" x="24.0039" y="945.1568">["クライアントタイプ" == "GUIを提供しないクライアント"]</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="135.0219" y1="992.0762" y2="988.6471"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="135.0219" y1="992.0762" y2="995.5054"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="328.339" y1="992.0762" y2="992.0762"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="102.8738" x="176.3858" y="979.5284">認可コードを送信する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="1072.9822" y2="1069.5531"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="730.8329" x2="722.2601" y1="1072.9822" y2="1076.4113"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="731.6902" y1="1072.9822" y2="1072.9822"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="283.7604" x="268.7579" y="1021.6156">Clovaアクセストークンをリクエストし、次の情報を送信する</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="173.171" x="268.7579" y="1034.5552">- LINEアカウントのアクセストークン</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="108.8748" x="268.7579" y="1047.4948">- クライアント認証情報</text><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="316.3371" x="273.9016" y="1060.4344">(CLOVA_OAUTH_CLIENT_ID、CLOVA_OAUTH_CLIENT_SECRET)</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="135.0219" y1="1115.0694" y2="1111.6403"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="135.0219" y1="1115.0694" y2="1118.4985"/><line style="stroke: #000000; stroke-width: 0.8572820263029712; stroke-dasharray: 2.0,2.0;" x1="126.4491" x2="735.9766" y1="1115.0694" y2="1115.0694"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="160.3117" x="351.4856" y="1102.5216">Clovaアクセストークンを送信する</text><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="834.5641" x2="825.9912" y1="1157.1566" y2="1153.7275"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="834.5641" x2="825.9912" y1="1157.1566" y2="1160.5857"/><line style="stroke: #000000; stroke-width: 0.8572820263029712;" x1="126.4491" x2="835.4213" y1="1157.1566" y2="1157.1566"/><text fill="#000000" font-family="Noto Sans CJK JP" font-size="10.2874" lengthAdjust="spacingAndGlyphs" textLength="260.6137" x="351.057" y="1144.6088">Clovaアクセストークンを使ってCICとの接続を開始する</text><!--
@startuml
scale max 880 width
skinparam sequenceMessageAlign center
skinparam shadowing false
skinparam roundcorner 10
skinparam padding 10
skinparam defaultFontSize 12
skinparam defaultFontName "Noto Sans CJK JP"

skinparam note {
  BackgroundColor #9EA0CA
  BorderColor #ffffff
  FontColor #ffffff
  FontSize 14
  FontStyle bold
}

skinparam sequence {
  ArrowColor #000000
  ActorBorderColor #000000
  ActorFontStyle Bolder


  LifeLineBorderColor #000000
  LifeLineBackgroundColor transparent
  ParticipantBorderColor transparent
  ParticipantFontSize 14
  ParticipantFontColor #ffffff
  ParticipantFontStyle bold

  BoxBorderColor #000000
  BoxFontColor #ffffff
    BoxFontSize 14
    BoxFontStyle bold
}
hide footbox

skinparam activity {
  BackgroundColor #9EA0CA
  BarColor #ffffff
  BorderColor #ffffff
  DiamondBackgroundColor #05D686
  DiamondBorderColor #ffffff
  DiamondFontColor #ffffff
  DiamondFontSize 14
  DiamondFontStyle bold
  FontColor #ffffff 
  FontSize 14
  FontStyle bold
}

participant "GUIを提供しないクライアント" as device #9EA0CA
participant "GUIを提供するクライアント" as app #9EA0CA
participant "LINE認可サーバー" as nauth #05D686
participant "Clova認可サーバー" as cauth #05D686
participant CIC as cic #05D686

activate app
  app -> app: LINEログイン

  app ->> nauth: LINEアカウント情報を送信する

  activate nauth
    nauth - ->> app: LINEアカウントの\nアクセストークンを送信する
  deactivate nauth

  app ->> cauth: 認可コードをリクエストする(次の情報を送信する)\l- LINEアカウントのアクセストークン\l- クライアント認証情報(CLOVA_OAUTH_CLIENT_ID)

activate cauth

deactivate app

alt "利用規約に同意しているか" == "同意している"
    cauth - ->> app: 認可コードを送信する(200 OK)
    activate app
    deactivate app
else 利用規約に同意しているか == "同意していない"
  cauth - ->> app: authorization、redirect_uriを送信する\l(451 Unavailable For Legal Reasons)
  activate app
    app -> app: 利用規約ページ(redirect_uri)にリダイレクトする
    app ->> cauth: 利用規約への同意結果を送信する(submit)
    cauth - ->> app: 結果を送信する(302 Found)\l- 成功：clova://agreement-success\l- 失敗：clova://agreement-failure
  deactivate cauth
end

alt "クライアントタイプ" == "GUIを提供するクライアント"
  app ->> cauth: Clovaアクセストークンをリクエストし、次の情報を送信する\l- LINEアカウントのアクセストークン\l- クライアント認証情報\l  (CLOVA_OAUTH_CLIENT_ID、CLOVA_OAUTH_CLIENT_SECRET)

  activate cauth
    cauth - ->> app: Clovaアクセストークンを送信する
  deactivate cauth

  app ->> cic: Clovaアクセストークンを使ってCICとの接続を開始する
  activate cic
  deactivate cic

else "クライアントタイプ" == "GUIを提供しないクライアント"
  app ->> device: 認可コードを送信する
  deactivate app

  activate device
    device ->> cauth: Clovaアクセストークンをリクエストし、次の情報を送信する\l- LINEアカウントのアクセストークン\l- クライアント認証情報\l  (CLOVA_OAUTH_CLIENT_ID、CLOVA_OAUTH_CLIENT_SECRET)

    activate cauth
        cauth - ->> device: Clovaアクセストークンを送信する
    deactivate cauth

    device ->> cic: Clovaアクセストークンを使ってCICとの接続を開始する

    activate cic
  end

@enduml

PlantUML version 1.2019.09(Tue Aug 27 01:19:51 JST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_202-b08
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>