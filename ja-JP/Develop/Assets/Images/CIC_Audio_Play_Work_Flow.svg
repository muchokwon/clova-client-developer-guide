<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="667.7264px" preserveAspectRatio="none" style="width:874px;height:667px;" version="1.1" viewBox="0 0 874 667" width="874.3068px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="52.2043" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="136.0513"/><rect fill="#FFFFFF" height="109.2121" style="stroke: #FFFFFF; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="278.6853"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="245.6192" y1="278.6853" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="253.7523" y1="278.6853" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="253.7523" y1="278.6853" y2="278.6853"/><rect fill="#FFFFFF" height="45.6978" style="stroke: #FFFFFF; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="439.2121"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="245.6192" y1="439.2121" y2="484.9099"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="253.7523" y1="439.2121" y2="484.9099"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="253.7523" y1="484.9099" y2="484.9099"/><rect fill="#FFFFFF" height="114.0157" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="537.1141"/><rect fill="#FFFFFF" height="90.4298" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="725.4713" y="188.2555"/><rect fill="#FFFFFF" height="52.2043" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="725.4713" y="484.9099"/><rect fill="#FFFFFF" height="252.7357" rx="4.0665" ry="4.0665" style="stroke: #000000; stroke-width: 1.6266173752310535;" width="570.1294" x="191.1275" y="341.3863"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="38.2255" x2="38.2255" y1="82.2204" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268; stroke-dasharray: 1.0,4.0;" x1="38.2255" x2="38.2255" y1="387.8974" y2="439.2121"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="38.2255" x2="38.2255" y1="439.2121" y2="658.4496"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="249.6858" x2="249.6858" y1="82.2204" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268; stroke-dasharray: 1.0,4.0;" x1="249.6858" x2="249.6858" y1="387.8974" y2="439.2121"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="249.6858" x2="249.6858" y1="439.2121" y2="658.4496"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="729.5379" x2="729.5379" y1="82.2204" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268; stroke-dasharray: 1.0,4.0;" x1="729.5379" x2="729.5379" y1="387.8974" y2="439.2121"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="729.5379" x2="729.5379" y1="439.2121" y2="658.4496"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42.2921" x="14.6396" y="71.9429">ユーザー</text><ellipse cx="38.2255" cy="10.573" fill="#9EA0CA" rx="6.5065" ry="6.5065" style="stroke: #000000; stroke-width: 1.6266173752310535;"/><path d="M38.2255,17.0795 L38.2255,39.0388 M27.6525,23.586 L48.7985,23.586 M38.2255,39.0388 L27.6525,51.2384 M38.2255,39.0388 L48.7985,51.2384 " fill="none" style="stroke: #000000; stroke-width: 1.6266173752310535;"/><rect fill="#9EA0CA" height="41.9744" rx="4.0665" ry="4.0665" style="stroke: #FFFFFF; stroke-width: 1.21996303142329;" width="100.8503" x="199.2606" y="39.4328"/><text fill="#FFFFFF" font-family="Noto Sans CJK KR" font-size="11.3863" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73.1978" x="213.0869" y="65.079">クライアント</text><rect fill="#05D686" height="41.9744" rx="4.0665" ry="4.0665" style="stroke: #FFFFFF; stroke-width: 1.21996303142329;" width="47.1719" x="705.9519" y="39.4328"/><text fill="#FFFFFF" font-family="Noto Sans CJK KR" font-size="11.3863" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.5194" x="719.7782" y="65.079">CIC</text><rect fill="#FFFFFF" height="52.2043" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="136.0513"/><rect fill="#FFFFFF" height="109.2121" style="stroke: #FFFFFF; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="278.6853"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="245.6192" y1="278.6853" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="253.7523" y1="278.6853" y2="387.8974"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="253.7523" y1="278.6853" y2="278.6853"/><rect fill="#FFFFFF" height="45.6978" style="stroke: #FFFFFF; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="439.2121"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="245.6192" y1="439.2121" y2="484.9099"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="253.7523" y1="439.2121" y2="484.9099"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="245.6192" x2="253.7523" y1="484.9099" y2="484.9099"/><rect fill="#FFFFFF" height="114.0157" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="245.6192" y="537.1141"/><rect fill="#FFFFFF" height="90.4298" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="725.4713" y="188.2555"/><rect fill="#FFFFFF" height="52.2043" style="stroke: #000000; stroke-width: 0.8133086876155268;" width="8.1331" x="725.4713" y="484.9099"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="243.9926" x2="235.8595" y1="136.0513" y2="132.7981"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="243.9926" x2="235.8595" y1="136.0513" y2="139.3045"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="38.2255" x2="244.8059" y1="136.0513" y2="136.0513"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="175.6747" x="54.085" y="111.8712">音楽を再生するようにリクエストする：</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="107.3567" x="88.244" y="124.1471">「楽しい曲を再生して」</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="723.8447" x2="715.7116" y1="188.2555" y2="185.0023"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="723.8447" x2="715.7116" y1="188.2555" y2="191.5088"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="249.6858" x2="724.658" y1="188.2555" y2="188.2555"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="146.3956" x="414.3808" y="164.0755">ユーザーのリクエストを送信する</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="179.7412" x="397.7079" y="176.3514">(SpeechRecognizer.Recognizeイベント)</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="733.6044" x2="767.7634" y1="228.1839" y2="228.1839"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="767.7634" x2="767.7634" y1="228.1839" y2="238.7569"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="734.4177" x2="767.7634" y1="238.7569" y2="238.7569"/><polygon fill="#000000" points="742.5508,235.5037,734.4177,238.7569,742.5508,242.0102,739.2976,238.7569" style="stroke: #000000; stroke-width: 0.8133086876155268;"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="117.1165" x="747.4307" y="216.2797">ユーザーの発話を解析する</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="261.8854" y1="278.6853" y2="275.4321"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="261.8854" y1="278.6853" y2="281.9385"/><line style="stroke: #000000; stroke-width: 0.8133086876155268; stroke-dasharray: 2.0,2.0;" x1="253.7523" x2="728.7246" y1="278.6853" y2="278.6853"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="265.9519" x="358.6691" y="266.7811">オーディオ再生を指示する(AudioPlayer.Playディレクティブ)</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="287.9113" y1="318.6137" y2="318.6137"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="287.9113" x2="287.9113" y1="318.6137" y2="329.1867"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="254.5656" x2="287.9113" y1="329.1867" y2="329.1867"/><polygon fill="#000000" points="262.6987,325.9335,254.5656,329.1867,262.6987,332.4399,259.4455,329.1867" style="stroke: #000000; stroke-width: 0.8133086876155268;"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="328.5767" x="267.5786" y="306.7095">AudioPlayer.PlayディレクティブのaudioItem.streamフィールドを解析する</text><path d="M195.1941,341.3863 L258.6322,341.3863 L258.6322,363.3457 L250.4991,371.4787 L191.1275,371.4787 L191.1275,345.4529 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.8133086876155268;"/><rect fill="none" height="252.7357" rx="4.0665" ry="4.0665" style="stroke: #000000; stroke-width: 1.6266173752310535;" width="570.1294" x="191.1275" y="341.3863"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.6396" x="211.4603" y="360.4641">opt</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180.5545" x="278.9649" y="361.2774">[audioItem.stream.urlPlayable == false]</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="243.9926" x="261.8854" y="417.5482">オーディオ再生が開始される直前まで時間が経過した後</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="723.8447" x2="715.7116" y1="484.9099" y2="481.6567"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="723.8447" x2="715.7116" y1="484.9099" y2="488.1631"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="249.6858" x2="724.658" y1="484.9099" y2="484.9099"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="440" x="267.5786" y="460.7298">audioItem.streamフィールドの情報を使って、実際のオーディオストリームの情報をリクエストする</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="182.9945" x="396.0813" y="473.0057">(AudioPlayer.StreamRequestedイベント)</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="261.8854" y1="537.1141" y2="533.8609"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="261.8854" y1="537.1141" y2="540.3674"/><line style="stroke: #000000; stroke-width: 0.8133086876155268; stroke-dasharray: 2.0,2.0;" x1="253.7523" x2="728.7246" y1="537.1141" y2="537.1141"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="224.4732" x="379.4085" y="512.9341">再生できるオーディオストリームの情報を送信する</text><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="193.5675" x="394.8614" y="525.21">(AudioPlayer.StreamDeliverディレクティブ)</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="287.9113" y1="577.0425" y2="577.0425"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="287.9113" x2="287.9113" y1="577.0425" y2="587.6155"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="254.5656" x2="287.9113" y1="587.6155" y2="587.6155"/><polygon fill="#000000" points="262.6987,584.3623,254.5656,587.6155,262.6987,590.8688,259.4455,587.6155" style="stroke: #000000; stroke-width: 0.8133086876155268;"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="352.1627" x="267.5786" y="565.1383">AudioPlayer.StreamDeliverディレクティブのaudioStreamフィールドを解析する</text><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="253.7523" x2="287.9113" y1="633.2371" y2="633.2371"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="287.9113" x2="287.9113" y1="633.2371" y2="643.8101"/><line style="stroke: #000000; stroke-width: 0.8133086876155268;" x1="254.5656" x2="287.9113" y1="643.8101" y2="643.8101"/><polygon fill="#000000" points="262.6987,640.5568,254.5656,643.8101,262.6987,647.0633,259.4455,643.8101" style="stroke: #000000; stroke-width: 0.8133086876155268;"/><text fill="#000000" font-family="Noto Sans CJK KR" font-size="9.7597" lengthAdjust="spacingAndGlyphs" textLength="117.1165" x="267.5786" y="621.3329">オーディオ再生を開始する</text><!--
@startuml
scale max 880 width
skinparam sequenceMessageAlign center
skinparam shadowing false
skinparam roundcorner 10
skinparam padding 10
skinparam defaultFontSize 12
skinparam defaultFontName "Noto Sans CJK KR"

skinparam note {
  BackgroundColor #9EA0CA
  BorderColor #ffffff
  FontColor #ffffff
  FontSize 14
  FontStyle bold
}

skinparam sequence {
  ArrowColor #000000
  ActorBorderColor #000000
  ActorFontStyle Bolder


  LifeLineBorderColor #000000
  LifeLineBackgroundColor transparent
  ParticipantBorderColor transparent
  ParticipantFontSize 14
  ParticipantFontColor #ffffff
  ParticipantFontStyle bold

  BoxBorderColor #000000
  BoxFontColor #ffffff
    BoxFontSize 14
    BoxFontStyle bold
}
hide footbox

skinparam activity {
  BackgroundColor #9EA0CA
  BarColor #ffffff
  BorderColor #ffffff
  DiamondBackgroundColor #05D686
  DiamondBorderColor #ffffff
  DiamondFontColor #ffffff
  DiamondFontSize 14
  DiamondFontStyle bold
  FontColor #ffffff 
  FontSize 14
  FontStyle bold
}

actor ユーザー as user #9EA0CA
participant クライアント as client #9EA0CA
participant CIC as cic #05D686


user ->> client : 音楽を再生するようにリクエストする：\n「楽しい曲を再生して」

activate client
  client ->> cic : ユーザーのリクエストを送信する\n(SpeechRecognizer.Recognizeイベント)
deactivate client

activate cic
  cic -> cic : ユーザーの発話を解析する
  cic - ->> client : オーディオ再生を指示する(AudioPlayer.Playディレクティブ)
deactivate cic

activate client
  client -> client : AudioPlayer.PlayディレクティブのaudioItem.streamフィールドを解析する

opt audioItem.stream.urlPlayable == false

... オーディオ再生が開始される直前まで時間が経過した後 ...

  client ->> cic : audioItem.streamフィールドの情報を使って、実際のオーディオストリームの情報をリクエストする\n(AudioPlayer.StreamRequestedイベント)
  deactivate client
  activate cic

    cic - ->> client : 再生できるオーディオストリームの情報を送信する\n(AudioPlayer.StreamDeliverディレクティブ)
  deactivate cic
  activate client
    client -> client : AudioPlayer.StreamDeliverディレクティブのaudioStreamフィールドを解析する
end

client -> client : オーディオ再生を開始する

@enduml

PlantUML version 1.2019.09(Tue Aug 27 01:19:51 JST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_202-b08
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>